#!/bin/bash

if [ `hostname` == "@PL_MASTER_SERVER@" ]
then
  found=1
  while [ $found -eq 1 ]
  do 
    found=0
    for x in `find @PRODDIR@/repository/ @PRODDIR@/checksum/ \
              -type d -print`
    do 
      files=`ls $x | wc -l`
      if [ $files -eq 0 ]
      then 
        echo Deleting Empty Dir: $x
        rmdir $x
        found=1
      fi
    done
  done
fi

if [ `hostname` == "@PL_FILE_SERVER@" ]
then
  found=1
  while [ $found -eq 1 ]
  do 
    found=0
    for x in `find @NODEDIR@/repository/ @NODEDIR@/working/ \
              -type d -print` 
    do 
      files=`ls $x | wc -l`
      if [ $files -eq 0 ]
      then 
        echo Deleting Empty Dir: $x
        rmdir $x
      fi
    done
  done
fi

echo "ALL DONE!"
