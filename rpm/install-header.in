#!/bin/sh
PATH=/bin:/usr/bin
more <<EOF

                    Temerity Software, Inc.
                      License Agreement
                    PIPELINE, VERSION @VERSION@

TEMERITY SOFTWARE, INC ("Temerity") IS WILLING TO LICENSE PIPELINE, 
VERSION @VERSION@ @VERSION, TO LICENSEE ONLY UPON THE CONDITION THAT LICENSEE 
ACCEPTS ALL OF THE TERMS CONTAINED IN THIS LICENSE AGREEMENT ("AGREEMENT").
PLEASE READ THE TERMS AND CONDITIONS OF THIS AGREEMENT CAREFULLY. BY 
DOWNLOADING OR INSTALLING THIS SOFTWARE, LICENSEE ACCEPTS THE TERMS AND 
CONDITIONS OF THIS LICENSE AGREEMENT. INDICATE ACCEPTANCE BY SELECTING THE 
"ACCEPT" BUTTON AT THE BOTTOM OF THIS AGREEMENT OR BY ANSWERING "YES" TO 
THE QUESTION ASKED AT THE END OF THIS AGREEMENT: "Do you agree to the above
license terms?". IF YOU ARE NOT WILLING TO BE BOUND BY ALL THE TERMS, 
SELECT THE "DECLINE" BUTTON AT THE BOTTOM OF THE AGREEMENT OR ANSWER 
"NO" TO THE QUESTION ASKED AT THE END OF THIS AGREEMENT. IN THAT EVENT 
THE DOWNLOAD OR INSTALL PROCESS WILL NOT CONTINUE.

1. DEFINITIONS. "Temerity" means Temerity Software, Inc.  "Software" means 
Pipeline, Version @VERSION@, software in binary and/or source code forms, 
any other machine readable materials (including, but not limited to, 
libraries, source files, header files, and data files), any user manuals, 
programming guides and other documentation provided to Licensee by Temerity
under this Agreement.

2. LICENSE TO USE. Temerity grants you a non-exclusive and non-transferable
license only for the internal use of Software, by the number of users and 
the class of computer hardware for which the corresponding fee has been 
paid.

3. RESTRICTIONS. Software is confidential and copyrighted. Title to 
Software and all associated intellectual property rights is retained by 
Temerity. You may not make copies of Software, other than a single copy 
of Software for archival purposes. Unless enforcement is prohibited by 
applicable law, you may not modify, decompile, or reverse engineer 
Software. You acknowledge that Software is not designed, licensed or 
intended for use in the design, construction, operation or maintenance of 
any nuclear facility. Temerity disclaims any express or implied warranty 
of fitness for such uses. No right, title or interest in or to any 
trademark, service mark, logo or trade name of Temerity or its licensors 
is granted under this Agreement.

4. LIMITED WARRANTY. Temerity warrants to you that for a period of ninety 
(90) days from the date of purchase, as evidenced by a copy of the receipt,
the media on which Software is furnished (if any) will be free of defects 
in materials and workmanship under normal use. Except for the foregoing, 
Software is provided "AS IS". Your exclusive remedy and Temerity's entire 
liability under this limited warranty will be at Temerity's option to 
replace Software media or refund the fee paid for Software.

5. DISCLAIMER OF WARRANTY. UNLESS SPECIFIED IN THIS AGREEMENT, ALL EXPRESS 
OR IMPLIED CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING ANY 
IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR 
NON-INFRINGEMENT, ARE DISCLAIMED, EXCEPT TO THE EXTENT THAT THESE 
DISCLAIMERS ARE HELD TO BE LEGALLY INVALID.

6. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO 
EVENTWILL TEMERITY BE LIABLE FOR ANY LOST REVENUE, PROFIT OR DATA, OR FOR 
SPECIAL, INDIRECT, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER 
CAUSED REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF OR RELATED 
TO THE USE OF OR INABILITY TO USE SOFTWARE, EVEN IF TEMERITY HAS BEEN 
ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. In no event will Temerity's 
liability to you, whether in contract, tort (including negligence), or 
otherwise, exceed the amount paid by you for Software under this Agreement.
The foregoing limitations will apply even if the above stated warranty 
fails of its essential purpose.

7. SEVERABILITY. If any provision of this Agreement is held to be 
unenforceable, this Agreement will remain in effect with the provision 
omitted, unless omission would frustrate the intent of the parties. In 
which event, the parties' obligations under the remaining terms of the 
Agreement will be conformed to accomplish the parties' original intent 
from the overall Agreement.

8. INTEGRATION. This Agreement is the entire agreement between you and 
Temerity relating to its subject matter. It supersedes all prior or 
contemporaneous oral or written communications, proposals, representations 
and warranties and prevails over any conflicting or additional terms of 
any quote, order, acknowledgment, or other communication between the 
parties relating to its subject matter during the term of this Agreement. 
No modification of this Agreement will be binding, unless in writing and 
signed by an authorized representative of each party.

For inquiries please contact:

  Temerity Software, Inc.
  475 Central Avenue, Suite 300
  St. Petersburg, Florida  33701

  http://www.temerity.us

EOF

agreed=0
while [ $agreed != 1 ] 
do
  echo
  echo "Do you agree to the above license terms? [yes/no] "

  read reply leftover
  case "$reply" in
    ("yes" | "Yes" | "YES")
      agreed=1;;
    ("no" | "No" | "NO") 
      echo "If you don't agree to the license you can't install this sofware.";
      exit 1;;
  esac
done

if [ ! -w `pwd` ] 
then
    echo "You do not have write permission for (`pwd`)!"
    echo 
    echo "Pipeline installation failed."
    exit 1
fi

rpm=pipeline-@DOMAIN@-@VERSION@-1.i686.rpm

if [ -x /usr/bin/md5sum ]
then
  echo "Unpacking..."
  tail +152 $0 > $rpm

  echo -n "Verifying Software Integrity... "
  if echo "@CHECKSUM@" | /usr/bin/md5sum --check --status - 
  then 
    echo "OK"
  else 
    echo "CORRUPTED"
    echo 
    echo "Installation failed."
    exit 1
  fi
else
  echo "Unable to locate (/usr/bin/md5sum) needed to verify software integrity."
  echo 
  echo "Installation failed."
  exit 1
fi

echo "Install the RPM now? [yes/no]"
read reply leftover
case "$reply" in
  ("yes" | "Yes" | "YES")
    rpm -Uvh $rpm;;
esac
exit 0
